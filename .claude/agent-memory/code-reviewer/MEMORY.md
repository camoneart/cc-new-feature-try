# Code Reviewer エージェント メモリ

## プロジェクト情報

- **プロジェクト名**: cc-new-feature-try
- **目的**: Claude Code の新機能を試すためのサンドボックスプロジェクト
- **現在のタスク**: Issue #53 - エージェント memory フロントマター（永続メモリ）の試行

## レビュー対象ファイルの分析

### `.claude/agents/code-reviewer.md`

#### 良い点

1. **フロントマターの構成が適切**: `description`、`memory`、`model` の3フィールドが簡潔にまとまっている
2. **memory スコープの選択**: `project` スコープを選択しており、プロジェクト固有のレビュー知見を蓄積するという目的に合致している
3. **model の選択**: `sonnet` を選択しており、レビュータスクにはコスト効率の良い選択
4. **役割の明確化**: 「コード品質」「パターン学習」「リスク指摘」の3つの役割が明確に定義されている
5. **レビュー観点が構造化されている**: 4つのカテゴリに分類されており、漏れなくレビューを行うためのフレームワークとして機能する

#### 改善点・気づき

1. **メモリの保存先に関する明示的な指示がない**: `memory: project` を設定しているが、エージェント自身がどのようにメモリを保存・参照するかの具体的な手順が記載されていない。実際のメモリ保存は Claude Code のシステムが自動的に処理するため、エージェント定義ファイル内で手順を書く必要はないが、メモリにどのような情報を優先的に保存するかの優先順位があると更に良い
2. **レビュー出力フォーマットの未定義**: レビュー結果をどのような形式で出力するかが定義されていない。テンプレートがあると一貫性のあるレビューが可能になる
3. **エージェント連携の記述がない**: Agent Teams として他のエージェントと連携する場合の振る舞いが未定義。将来的にチーム構成でエージェントを使う際に考慮が必要
4. **セキュリティレビューの深度が不明**: 「セキュリティリスクを指摘する」とあるが、どの程度の深さでセキュリティレビューを行うかが曖昧

## 発見したプロジェクトパターンと規約

1. **ディレクトリ構造**: `.claude/agents/` にエージェント定義ファイルを配置する規約
2. **ファイル命名**: エージェント名をそのままファイル名にする（例: `code-reviewer.md`）
3. **フロントマター構造**: YAML フロントマターで `description`、`memory`、`model` を定義
4. **言語**: エージェント定義は日本語で記述
5. **メモリスコープ**: このプロジェクトでは `project` スコープを使用（プロジェクト固有の知見を蓄積する目的）

## 今後のレビューに活かせる知見

1. **memory フロントマターの各スコープの使い分け**:
   - `user`: ユーザー個人の好みやスタイルなど、プロジェクトを跨いで共通する情報
   - `project`: プロジェクト固有のパターン、規約、設計判断
   - `local`: ローカル環境固有の設定や一時的な知見
2. **エージェント定義ファイルのベストプラクティス**: 役割・メモリ活用方法・具体的な観点を明記することで、エージェントの振る舞いが安定する
3. **サンドボックスプロジェクトでの試行**: 新機能の検証には、本番プロジェクトとは別のサンドボックスを用いることで安全に試行できる
4. **レビュー時はフロントマターの設定値だけでなく、その値が目的に合致しているかも確認する**

## レビュー履歴

- 2026-03-01: 初回レビュー実施。`.claude/agents/code-reviewer.md` の構造・内容を分析。全体として良好な構成だが、出力フォーマットの定義やメモリ保存の優先順位の追加を推奨。
- 2026-03-01: 2回目レビュー実施。`.claude/agents/style-checker.md` を分析。`memory: user` スコープの選択が目的に合致しており、メモリ活用セクションも具体的に記載されている点が良好。改善点として、具体的なスタイルルールの参照先、出力フォーマットの定義、プロジェクト設定との衝突時の優先順位方針、他エージェントとの連携記述の追加を推奨。
