# /copy「常にレスポンス全体をコピー」オプション 試行レポート

## 基本情報

| 項目 | 内容 |
|------|------|
| Issue | #78 |
| 対象機能 | `/copy` ピッカーに「常にレスポンス全体をコピー」オプション追加 |
| 対象バージョン | v2.1.63 |
| 試行バージョン | v2.1.63 |

## 機能概要

`/copy` コマンドのコードブロックピッカーに「常にレスポンス全体をコピー」オプションが追加された。一度選択すると、以降の `/copy` コマンドはピッカーをスキップしてレスポンス全体を直接コピーするようになる。設定はセッションをまたいで永続化される。

## 動作確認結果

### ケース1: コードブロックなしの応答で `/copy`

テーブルやマークダウンのみの解説応答に対して `/copy` を実行。

**結果**: ピッカーは表示されず、レスポンス全体が即座にコピーされた。（既存の挙動と同じ）

```
Copied to clipboard (914 characters, 35 lines)
```

### ケース2: 複数コードブロックを含む応答で「常にレスポンス全体をコピー」を選択

Python / JavaScript / Rust の3つのコードブロックを含む応答に対して `/copy` を実行。

**結果**: インタラクティブピッカーが表示され、「常にレスポンス全体をコピー」を選択。設定が保存された旨のメッセージが表示された。

```
Copied to clipboard (985 characters, 46 lines)
Preference saved. Use /config to change copyFullResponse
```

### ケース3: 設定保存後に複数コードブロック応答で `/copy`

5つのコードブロック（Go / Swift / Ruby / Java / TypeScript）を含む応答に対して `/copy` を実行。

**結果**: ピッカーがスキップされ、レスポンス全体が即座にコピーされた。

```
Copied to clipboard (1085 characters, 57 lines)
```

### ケース4: さらに別の応答（コードブロックなし）で `/copy`

コードブロックを含まない応答に対して `/copy` を実行。

**結果**: 引き続きピッカーなしでレスポンス全体がコピーされた。設定が永続化されていることを確認。

```
Copied to clipboard (622 characters, 20 lines)
```

## 挙動まとめ

| 状態 | `/copy` の挙動 |
|------|---------------|
| 設定前・コードブロックなし | レスポンス全体を即座にコピー |
| 設定前・コードブロック複数 | ピッカーを表示（「常にレスポンス全体をコピー」オプションあり） |
| 設定後・コードブロック複数 | ピッカーをスキップし、レスポンス全体を即座にコピー |
| 設定後・コードブロックなし | レスポンス全体を即座にコピー |

## 設定管理

- **設定名**: `copyFullResponse`
- **保存方法**: ピッカーで「常にレスポンス全体をコピー」を選択すると自動保存
- **リセット方法**: `/config` コマンドから `copyFullResponse` を変更
- **永続化**: セッションをまたいで保持される

## ユースケース

- コードブロックの個別選択が不要で、常にレスポンス全体をコピーしたいユーザー向け
- ドキュメンテーションやレビュー用途で、レスポンスの文脈ごとコピーしたい場合
- `/copy` 実行時にピッカーの選択ステップを省略し、ワークフローを高速化したい場合

## 所感

- ピッカーで毎回「Full response」を選ぶ手間が省けるのは便利
- 設定保存時に `Preference saved. Use /config to change copyFullResponse` と表示されるため、リセット方法がすぐわかるUXが良い
- #44 の `/copy` コマンド（コードブロックピッカー）の自然な拡張で、ユーザーの好みに合わせた使い分けができる
